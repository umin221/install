webpackJsonp([0],{A71v:function(e,s,t){e.exports=t("Trbc")(198)},OEeH:function(e,s,t){e.exports=t("Trbc")(183)},"YA+a":function(e,s,t){e.exports=t("Trbc")(228)},kyI1:function(e,s,t){(e.exports=t("FZ+f")(!1)).push([e.i,'\n@charset "UTF-8";\n/* ==================================================\n * \t\t\t \t\t 全局Sass变量\n * ================================================= */\n.install-container .icon-scan {\n  margin-left: 2px;\n}\n.install-container .error-tips {\n  font-size: 0.75rem;\n  color: red;\n  font-weight: bold;\n  padding: 10px;\n}\n',""])},sVBY:function(e,s,t){var r=t("kyI1");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("64c3bc38",r,!0)},tOCr:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r=t("Dd8w"),a=t.n(r),o=t("NYxO"),i=t("A71v"),n=t("YA+a"),l=t("OEeH"),d={name:"detail",created:function(){var e=this,s=e.$route.query,t=KND.Util.parse(s.room);t.serial=t.serial||t["Serial Number"],e.assets=t,this.queryOrderLines({data:{"Order Header Id":e.assets["Original Order Id"]},success:function(s){if(s.items){s.items.forEach(function(s){"Panel"===s["KL Product Type LIC"]?e.panel.push(s):"Lock Body"===s["KL Product Type LIC"]&&e.body.push(s)});var t=e.panel[0]||{},r=e.body[0]||{};e.assets["KL Product Model No Panel"]=t["KL Product Model No Cal"],e.assets["KL Product Model No Lock Body"]=r["KL Product Model No Cal"],t["KL Final Product Id"]=t["KL Final Product Id"]||t["Product Id"],e.assets["Product Id"]=t["KL Final Product Id"]}}})},data:function(){return{assets:"",panel:[],body:[],slots:[{flex:1,values:[],className:"slot1",textAlign:"center"}],showBox:!1,lovType:"",error:{address:"",batch:""}}},computed:{serial:function(){var e=this,s=e.assets,t=s.serial;return t&&(t&&(s.serial=t.replace(/[\u4e00-\u9fa5]/g,"")),e.serialHasBind({serial:t,success:function(r){if(r.length){var a=KND.Util.parse(r.shift().super);if(a.Id===s.Id)return t;e.assets.serial=e.assets.serial="",e.error.serial=t,e.error.address=a.Province+a.City+a.County+a["Street Address"]+a["Street Address 2"]+a["Street Address 3"]+a["Street Address 4"],e.error.batch=a["KL Activity Id"]}else e.error={}}})),t}},methods:a()({},Object(o.mapActions)("detail",["queryOrderLines","installOrderAssets","serialHasBind"]),{saveFn:function(){var e=this,s=this,t=KND.Util.parse(KND.Session.get("userInfo"));tools.valid.call(s,function(){var r=s.assets;r.serial.length<10?Toast("条码至少是10个字符"):/[A-Za-z0-9]+$/.test(r.serial)?e.installOrderAssets({data:{Id:r.Id,"Serial Number":r.serial,"Product Id":r["Product Id"],"KL Product Model No Lock Body":r["KL Product Model No Lock Body"],"KL Product Model No Panel":r["KL Product Model No Panel"],"Personal Address Id":r["Personal Address Id"],"Login Name":t["Login Name"]},super:r}):Toast("条码必须包含字母或数字")})},toScanFn:function(){var e=this;tools.cordova.zBarScan(function(s){e.assets.serial=s})},enter:function(e,s){var t=e[0];this.showBox=!1,"panel"===s?(this.assets["Product Id"]=t["KL Final Product Id"],this.assets["KL Product Model No Panel"]=t["KL Product Model No Cal"]):this.assets["KL Product Model No Lock Body"]=t["KL Product Model No Cal"]},showLovFn:function(e){this.lovType=e,this.showBox=!0,this.slots[0].values=this[e]}}),components:{buttonGroup:i.default,cusField:n.default,menuBox:l.default}},c={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("mt-header",{attrs:{fixed:"",title:"安装扫码"}},[t("fallback",{attrs:{slot:"left"},slot:"left"})],1),e._v(" "),t("div",{staticClass:"wrapper"},[t("div",{staticClass:"mint-content install-container"},[t("cus-field",{staticClass:"disable",attrs:{label:"房号",tag:"房号",value:e.assets["Street Address 4"]}}),e._v(" "),t("cus-field",{directives:[{name:"valid",rawName:"v-valid.require",modifiers:{require:!0}}],attrs:{label:"产品条形码",tag:"产品条形码","data-value":e.serial,attr:{maxlength:15}},model:{value:e.assets.serial,callback:function(s){e.$set(e.assets,"serial",s)},expression:"assets['serial']"}},[t("div",{staticClass:"xs-icon icon-scan",on:{click:e.toScanFn}})]),e._v(" "),t("cus-field",{directives:[{name:"valid",rawName:"v-valid.require",modifiers:{require:!0}}],attrs:{label:"锁体型号",tag:"锁体型号",value:e.assets["KL Product Model No Lock Body"],"is-link":""},nativeOn:{click:function(s){e.showLovFn("body")}}}),e._v(" "),t("cus-field",{directives:[{name:"valid",rawName:"v-valid.require",modifiers:{require:!0}}],attrs:{label:"面板型号",tag:"面板型号",value:e.assets["KL Product Model No Panel"],"is-link":""},nativeOn:{click:function(s){e.showLovFn("panel")}}}),e._v(" "),e.error.batch?t("div",{staticClass:"error-tips"},[t("div",[e._v("错误：条码已绑定 <"+e._s(e.error.serial)+">")]),e._v(" "),t("div",[e._v("批次编号："+e._s(e.error.batch))]),e._v(" "),t("div",[e._v("安装地址："+e._s(e.error.address))])]):e._e(),e._v(" "),t("button-group",[t("mt-button",{staticClass:"single",nativeOn:{click:function(s){e.saveFn(s)}}},[e._v("保存")])],1)],1)]),e._v(" "),t("mt-popup",{attrs:{position:"bottom"},model:{value:e.showBox,callback:function(s){e.showBox=s},expression:"showBox"}},[t("menu-box",{attrs:{vk:"KL Product Model No Cal",type:e.lovType,slots:e.slots},on:{"my-enter":e.enter,"my-cancel":function(s){e.showBox=!1}}})],1)],1)},staticRenderFns:[]},u=t("VU/8")(d,c,!1,function(e){t("sVBY")},null,null);s.default=u.exports}});